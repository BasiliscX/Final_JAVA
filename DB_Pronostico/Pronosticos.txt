-- Podes copiar y pegar en una consulta esto para
-- Crear la DB
-- Cargar datos
-- Y visualizar

use master
go
create database PRONOSTICOS_DB
go
USE PRONOSTICOS_DB
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PAISES](
    [Id] [int] IDENTITY(1,1) NOT NULL,
    [Nombre] [varchar](100) NOT NULL,
    CONSTRAINT [PK_PAISES] PRIMARY KEY CLUSTERED([Id] ASC)
);
go
USE PRONOSTICOS_DB
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[RESULTADOS](
    [Id] [int] IDENTITY(1,1) NOT NULL,
    [Grupo] [char](1) NOT NULL,
    [Equipo_1] [int] NOT NULL,
    [Cantidad_goles_1] [int] NOT NULL,
    [Equipo_2] [int] NOT NULL,
    [Cantidad_goles_2] [int] NOT NULL,
    CONSTRAINT [PK_RESULTADOS] PRIMARY KEY CLUSTERED([Id] ASC),
    CONSTRAINT [FK_Equipo1] FOREIGN KEY ([Equipo_1]) REFERENCES [dbo].[PAISES]([Id]),
    CONSTRAINT [FK_Equipo2] FOREIGN KEY ([Equipo_2]) REFERENCES [dbo].[PAISES]([Id])
);
GO
USE PRONOSTICOS_DB
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PARTICIPANTES](
    [Id] [int] IDENTITY(1,1) NOT NULL,
    [Nombre] [varchar](100) NOT NULL,
    CONSTRAINT [PK_PARTICIPANTES] PRIMARY KEY CLUSTERED([Id] ASC)
);
GO
USE PRONOSTICOS_DB
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PRONOSTICOS](
    [Id] [int] IDENTITY(1,1) NOT NULL,
    [Participante] [int] NOT NULL,
    [Equipo_1] [int] NOT NULL,
    [Equipo_2] [int] NOT NULL,
    [Opcion] [bit] NOT NULL,
    CONSTRAINT [PK_PRONOSTICOS] PRIMARY KEY CLUSTERED([Id] ASC),
    CONSTRAINT [FK_Participante_Pronosticos] FOREIGN KEY ([Participante]) REFERENCES [dbo].[PARTICIPANTES]([Id]),
    CONSTRAINT [FK_Equipo1_Pronosticos] FOREIGN KEY ([Equipo_1]) REFERENCES [dbo].[PAISES]([Id]),
    CONSTRAINT [FK_Equipo2_Pronosticos] FOREIGN KEY ([Equipo_2]) REFERENCES [dbo].[PAISES]([Id])
);

-- Cargar tablas:

GO
USE PRONOSTICOS_DB
GO
INSERT INTO PARTICIPANTES VALUES ('Guillermo')
INSERT INTO PARTICIPANTES VALUES ('Chechu')
INSERT INTO PARTICIPANTES VALUES ('Facuu')
INSERT INTO PARTICIPANTES VALUES ('Patricio')

-- Grupo A: Catar, Ecuador, Senegal, Países Bajos
INSERT INTO PAISES VALUES ('Catar')
INSERT INTO PAISES VALUES ('Ecuador')
INSERT INTO PAISES VALUES ('Senegal')
INSERT INTO PAISES VALUES ('Países Bajos')

-- Grupo B: Inglaterra, República Islámica de Irán, Estados Unidos, Gales
INSERT INTO PAISES VALUES ('Inglaterra')
INSERT INTO PAISES VALUES ('Irán')
INSERT INTO PAISES VALUES ('Estados Unidos')
INSERT INTO PAISES VALUES ('Gales')

-- Grupo C: Argentina, Arabia Saudí, México, Polonia
INSERT INTO PAISES VALUES ('Argentina')
INSERT INTO PAISES VALUES ('Arabia Saudí')
INSERT INTO PAISES VALUES ('México')
INSERT INTO PAISES VALUES ('Polonia')

-- Grupo D: Francia, Australia, Dinamarca, Túnez
INSERT INTO PAISES VALUES ('Francia')
INSERT INTO PAISES VALUES ('Australia')
INSERT INTO PAISES VALUES ('Dinamarca')
INSERT INTO PAISES VALUES ('Túnez')

-- Grupo E: España, Costa Rica, Alemania, Japón
INSERT INTO PAISES VALUES ('España')
INSERT INTO PAISES VALUES ('Costa Rica')
INSERT INTO PAISES VALUES ('Alemania')
INSERT INTO PAISES VALUES ('Japón')

-- Grupo F: Bélgica, Canadá, Morruecos, Croacia
INSERT INTO PAISES VALUES ('Bélgica')
INSERT INTO PAISES VALUES ('Canadá')
INSERT INTO PAISES VALUES ('Morruecos')
INSERT INTO PAISES VALUES ('Croacia')

-- Grupo G: Brasil, Serbia, Suiza, Camerún
INSERT INTO PAISES VALUES ('Brasil')
INSERT INTO PAISES VALUES ('Serbia')
INSERT INTO PAISES VALUES ('Suiza')
INSERT INTO PAISES VALUES ('Camerún')

-- Grupo H: Portugal, Ghana, Uruguay, República de Corea
INSERT INTO PAISES VALUES ('Portugal')
INSERT INTO PAISES VALUES ('Ghana')
INSERT INTO PAISES VALUES ('Uruguay')
INSERT INTO PAISES VALUES ('Corea')

-- Resultados y marcadores del grupo A
-- Catar 0-2 Ecuador
INSERT INTO RESULTADOS VALUES ('A',1,0,2,2)
-- Senegal 0-2 Países Bajos
INSERT INTO RESULTADOS VALUES ('A',3,0,4,2)
-- Catar 1-3 Senegal
INSERT INTO RESULTADOS VALUES ('A',1,1,3,3)
-- Países Bajos 1-1 Ecuador
INSERT INTO RESULTADOS VALUES ('A',4,1,2,1)
-- Ecuador 1-2 Senegal
INSERT INTO RESULTADOS VALUES ('A',2,1,3,2)
-- Países Bajos 2-0 Catar
INSERT INTO RESULTADOS VALUES ('A',4,2,1,0)

-- Resultados y marcadores del grupo B
-- Inglaterra 6-2 Irán
INSERT INTO RESULTADOS VALUES ('B',5,6,6,2)
-- Estados Unidos 1-1 Gales
INSERT INTO RESULTADOS VALUES ('B',7,1,8,1)
-- Gales 0-2 Irán
INSERT INTO RESULTADOS VALUES ('B',8,0,6,2)
-- Inglaterra 0-0 Estados Unidos
INSERT INTO RESULTADOS VALUES ('B',5,0,7,0)
-- Gales 0-3 Inglaterra
INSERT INTO RESULTADOS VALUES ('B',8,0,5,3)
-- Irán 0-1 Estados Unidos
INSERT INTO RESULTADOS VALUES ('B',6,0,7,1)

-- Resultados y marcadores del grupo C
-- Argentina 1-2 Arabia Saudí
INSERT INTO RESULTADOS VALUES ('C',9,1,10,2)
-- México 0-0 Polonia
INSERT INTO RESULTADOS VALUES ('C',11,0,12,0)
-- Polonia 2-0 Arabia Saudí
INSERT INTO RESULTADOS VALUES ('C',12,2,10,0)
-- Argentina 2-0 México
INSERT INTO RESULTADOS VALUES ('C',9,2,11,0)
-- Polonia 0-2 Argentina
INSERT INTO RESULTADOS VALUES ('C',12,0,9,2)
-- Arabia Saudí 1-2 México
INSERT INTO RESULTADOS VALUES ('C',10,1,11,2)

-- Resultados y marcadores del grupo D
-- Dinamarca 0-0 Túnez
INSERT INTO RESULTADOS VALUES ('D',15,0,16,0)
-- Francia 4-1 Australia
INSERT INTO RESULTADOS VALUES ('D',13,4,14,1)
-- Túnez 0-1 Australia
INSERT INTO RESULTADOS VALUES ('D',16,0,14,1)
-- Francia 2-1 Dinamarca
INSERT INTO RESULTADOS VALUES ('D',13,2,15,1)
-- Australia 1-0 Dinamarca
INSERT INTO RESULTADOS VALUES ('D',14,1,15,0)
-- Túnez 1-0 Francia
INSERT INTO RESULTADOS VALUES ('D',16,1,13,0)

-- Resultados y marcadores del grupo E
-- Alemania 1-2 Japón
INSERT INTO RESULTADOS VALUES ('E',19,1,20,2)
-- España 7-0 Costa Rica
INSERT INTO RESULTADOS VALUES ('E',17,7,18,0)
-- Japón 0-1 Costa Rica
INSERT INTO RESULTADOS VALUES ('E',20,0,18,1)
-- España 1-1 Alemania
INSERT INTO RESULTADOS VALUES ('E',17,1,19,1)
-- Japón 2-1 España
INSERT INTO RESULTADOS VALUES ('E',20,2,17,1)
-- Costa Rica 2-4 Alemania
INSERT INTO RESULTADOS VALUES ('E',18,2,19,4)

-- Resultados y marcadores del grupo F
-- Marruecos 0-0 Croacia
INSERT INTO RESULTADOS VALUES ('F',23,0,24,0)
-- Bélgica 1-0 Canadá
INSERT INTO RESULTADOS VALUES ('F',21,1,22,0)
-- Bélgica 0-2 Marruecos
INSERT INTO RESULTADOS VALUES ('F',21,0,23,2)
-- Croacia 4-1 Canadá
INSERT INTO RESULTADOS VALUES ('F',24,4,22,1)
-- Croacia 0-0 Bélgica
INSERT INTO RESULTADOS VALUES ('F',24,0,21,0)
-- Canadá 1-2 Marruecos
INSERT INTO RESULTADOS VALUES ('F',22,1,23,2)

-- Resultados y marcadores del grupo G
-- Suiza 1-0 Camerún
INSERT INTO RESULTADOS VALUES ('G',27,1,28,0)
-- Brasil 2-0 Serbia
INSERT INTO RESULTADOS VALUES ('G',25,2,26,0)
-- Camerún 3-3 Serbia
INSERT INTO RESULTADOS VALUES ('G',28,3,26,3)
-- Brasil 1-0 Suiza
INSERT INTO RESULTADOS VALUES ('G',25,1,27,0)
-- Camerún 1-0 Brasil
INSERT INTO RESULTADOS VALUES ('G',28,1,25,0)
-- Serbia 2-3 Suiza
INSERT INTO RESULTADOS VALUES ('G',26,2,27,3)

-- Resultados y marcadores del grupo H
-- Uruguay 0-0 República de Corea
INSERT INTO RESULTADOS VALUES ('H',31,0,32,0)
-- Ghana 2-3 Portugal
INSERT INTO RESULTADOS VALUES ('H',30,2,29,3)
-- República de Corea 2-3 Ghana
INSERT INTO RESULTADOS VALUES ('H',32,2,30,3)
-- Portugal 2-0 Uruguay
INSERT INTO RESULTADOS VALUES ('H',29,2,31,0)
-- República de Corea 2-1 Portugal
INSERT INTO RESULTADOS VALUES ('H',32,2,29,1)
-- Ghana 0-2 Uruguay
INSERT INTO RESULTADOS VALUES ('H',30,0,31,2)

GO
USE PRONOSTICOS_DB
GO
-- Pariticipantes para los pronosticos
select P.Id, P.Nombre AS participante from PARTICIPANTES P

-- Paises de la copa
select P.Id, P.Nombre AS Pais from PAISES P

-- Resultados
SELECT R.Grupo, 
       P1.Nombre AS Pais, 
       R.Cantidad_goles_1 AS Goles, 
       P2.Nombre AS Pais, 
       R.Cantidad_goles_2 AS Goles
FROM RESULTADOS R
JOIN PAISES P1 ON P1.Id = R.Equipo_1
JOIN PAISES P2 ON P2.Id = R.Equipo_2;
